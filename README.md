# ofetch / nuxt self signed certificate issue reproduction

ASP.NET Core is able to use https while in development using a devcert generated by the dotnet cli.
This is required for many different valid reasons such as testing with secure httponly cookies, cors and authentication.

Unfortunately, Nuxt 3's useFetch composable (ofetch with de-duplication and caching under the hood)
does not really play well with self signed certificates.

## Installation and Startup

1. ensure you have `bun` and the `dotnet` sdk installed
2. ensure you have trusted the dotnet development certificate on your machine.
    to do this, you can run `dotnet dev-certs https -t`
3. start the webapi by going into the backend directory and
    running `dotnet restore && dotnet run -lp https`
4. start the nuxt frontend by going into the frontend directory and running `bun install && bun --bun run dev`
5. open the browser and notice the error
6. save any file to trigger an hmr refresh and notice a different error which results in less information than the previous.

funnily enough, in my actual project (not this repro), i only get to see the less informative `<no response> fetch failed` error.
which drove me mad, as it took a while to figure out it was the self signed ssl certificate that breaks this.

## Workaround the fetch error

1. stop the backend and run it without https support using `dotnet run -lp http`

This disables the https port and https redirection middleware. Which might not be what you want, if you have to work with secure http only cookies or other features that require https in aspnetcore.

## Workaround the error (different way)

1. use the `NODE_TLS_REJECT_UNAUTHORIZED=0` environment variable while keeping `dotnet run -lp https` and the error goes away too.

This ignores the SSL verification and also works fine in Bun but this workaround is hardly documented anywhere.
I first noticed this while browsing through closed issues in the ofetch repository, which is horrible for DX.